<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
	<meta name="generator" content="Hugo 0.49.2" />
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      PurpleScreen &middot; blog about open source
    
  </title>

  
  <link rel="stylesheet" href="https://purple-screen.com/css/poole.css">
  <link rel="stylesheet" href="https://purple-screen.com/css/syntax.css">
  <link rel="stylesheet" href="https://purple-screen.com/css/lanyon.css">
  <link rel="stylesheet" href="https://purple-screen.com/css/custom.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700|PT+Sans:400">

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://purple-screen.com/assets/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="https://purple-screen.com/assets/favicon.png">

  
  <link rel="alternate" type="application/rss+xml" title="RSS" href="https://purple-screen.com/atom.xml">
</head>


  
  <body>

    
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">


<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p>Blog about IT</p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item  active " href="https://purple-screen.com/">Home</a>
    <a class="sidebar-nav-item " href="https://purple-screen.com/post">Posts</a>

    
    
      
        <a class="sidebar-nav-item " href="https://purple-screen.com/about/">About</a>
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    

  </nav>

  <div class="sidebar-item">
    <p>Powered by <a href="https://gohugo.io/">Hugo</a>.</p>
    <p>Hosted on <a href="https://pages.github.com/">GitHub Pages</a> and <a href="https://cloudflare.com">CloudFlare</a>.</p>
    <p>&copy; 2014</p>
  </div>
</div>


    
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="https://purple-screen.com/" title="Home">PurpleScreen</a>
            <small>blog about open source</small>
            
          </h3>
        </div>
      </div>

      <div class="container content">





<div class="posts">
  
    <div class="post">
        <h1 class="post-title"><a href="https://purple-screen.com/2014/01/07/netcmdlets/">NetCmdlets</a></h1>
        <span class="post-date">Jan 7 2014</span>
        <p>Use all the power of PowerShell with <a href="http://www.netcmdlets.com" title="NetCmdlets" target="_blank">NetCmdlets</a>. Out of box you can: gain SSH access to ESXi 5.x hosts from PowerShell, work with multiple internet protocols (IMAP/POP/WebDAV/DNS/FTP/etc), deploy portable syslog server in seconds and much more.</p>

<p><em>Unfortunately community edition doesn&#8217;t support encryption-enabled cmdlets. To use SSH, SFTP you need to upgrade to paid version.</em></p>

    </div>
  
    <div class="post">
        <h1 class="post-title"><a href="https://purple-screen.com/2014/01/02/introducing-lanyon/">Introducing Lanyon</a></h1>
        <span class="post-date">Jan 2 2014</span>
        

<p>Lanyon is an unassuming <a href="http://jekyllrb.com">Jekyll</a> theme that places content first by tucking away navigation in a hidden drawer. It&rsquo;s based on <a href="http://getpoole.com">Poole</a>, the Jekyll butler.</p>

<h3 id="built-on-poole">Built on Poole</h3>

<p>Poole is the Jekyll Butler, serving as an upstanding and effective foundation for Jekyll themes by <a href="https://twitter.com/mdo">@mdo</a>. Poole, and every theme built on it (like Lanyon here) includes the following:</p>

<ul>
<li>Complete Jekyll setup included (layouts, config, <a href="https://purple-screen.com/404">404</a>, <a href="https://purple-screen.com/index.xml">RSS feed</a>, posts, and <a href="https://purple-screen.com/about">example page</a>)</li>
<li>Mobile friendly design and development</li>
<li>Easily scalable text and component sizing with <code>rem</code> units in the CSS</li>
<li>Support for a wide gamut of HTML elements</li>
<li>Related posts (time-based, because Jekyll) below each post</li>
<li>Syntax highlighting, courtesy Pygments (the Python-based code snippet highlighter)</li>
</ul>

<h3 id="lanyon-features">Lanyon features</h3>

<p>In addition to the features of Poole, Lanyon adds the following:</p>

<ul>
<li>Toggleable sliding sidebar (built with only CSS) via <strong>☰</strong> link in top corner</li>
<li>Sidebar includes support for textual modules and a dynamically generated navigation with active link support</li>
<li>Two orientations for content and sidebar, default (left sidebar) and <a href="https://github.com/poole/lanyon#reverse-layout">reverse</a> (right sidebar), available via <code>&lt;body&gt;</code> classes</li>
<li><a href="https://github.com/poole/lanyon#themes">Eight optional color schemes</a>, available via <code>&lt;body&gt;</code> classes</li>
</ul>

<p><a href="https://github.com/poole/lanyon#readme">Head to the readme</a> to learn more.</p>

<h3 id="browser-support">Browser support</h3>

<p>Lanyon is by preference a forward-thinking project. In addition to the latest versions of Chrome, Safari (mobile and desktop), and Firefox, it is only compatible with Internet Explorer 9 and above.</p>

<h3 id="download">Download</h3>

<p>Lanyon is developed on and hosted with GitHub. Head to the <a href="https://github.com/poole/lanyon">GitHub repository</a> for downloads, bug reports, and features requests.</p>

<p>Thanks!</p>

    </div>
  
    <div class="post">
        <h1 class="post-title"><a href="https://purple-screen.com/2014/01/01/example-content/">Example content</a></h1>
        <span class="post-date">Jan 1 2014</span>
        

<div class="message">
  Howdy! This is an example blog post that shows several types of HTML content supported in this theme.
</div>

<p>Cum sociis natoque penatibus et magnis <a href="#">dis parturient montes</a>, nascetur ridiculus mus. <em>Aenean eu leo quam.</em> Pellentesque ornare sem lacinia quam venenatis vestibulum. Sed posuere consectetur est at lobortis. Cras mattis consectetur purus sit amet fermentum.</p>

<blockquote>
<p>Curabitur blandit tempus porttitor. Nullam quis risus eget urna mollis ornare vel eu leo. Nullam id dolor id nibh ultricies vehicula ut id elit.</p>
</blockquote>

<p>Etiam porta <strong>sem malesuada magna</strong> mollis euismod. Cras mattis consectetur purus sit amet fermentum. Aenean lacinia bibendum nulla sed consectetur.</p>

<h2 id="inline-html-elements">Inline HTML elements</h2>

<p>HTML defines a long list of available inline tags, a complete list of which can be found on the <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element">Mozilla Developer Network</a>.</p>

<ul>
<li><strong>To bold text</strong>, use <code>&lt;strong&gt;</code>.</li>
<li><em>To italicize text</em>, use <code>&lt;em&gt;</code>.</li>
<li>Abbreviations, like <abbr title="HyperText Markup Langage">HTML</abbr> should use <code>&lt;abbr&gt;</code>, with an optional <code>title</code> attribute for the full phrase.</li>
<li>Citations, like <cite>&mdash; Mark otto</cite>, should use <code>&lt;cite&gt;</code>.</li>
<li><del>Deleted</del> text should use <code>&lt;del&gt;</code> and <ins>inserted</ins> text should use <code>&lt;ins&gt;</code>.</li>
<li>Superscript <sup>text</sup> uses <code>&lt;sup&gt;</code> and subscript <sub>text</sub> uses <code>&lt;sub&gt;</code>.</li>
</ul>

<p>Most of these elements are styled by browsers with few modifications on our part.</p>

<h2 id="heading">Heading</h2>

<p>Vivamus sagittis lacus vel augue rutrum faucibus dolor auctor. Duis mollis, est non commodo luctus, nisi erat porttitor ligula, eget lacinia odio sem nec elit. Morbi leo risus, porta ac consectetur ac, vestibulum at eros.</p>

<h3 id="code">Code</h3>

<p>Cum sociis natoque penatibus et magnis dis <code>code element</code> montes, nascetur ridiculus mus.</p>

<div class="highlight"><pre class="chroma"><code class="language-js" data-lang="js"><span class="c1">// Example can be run directly in your JavaScript console
</span><span class="c1"></span>
<span class="c1">// Create a function that takes two arguments and returns the sum of those arguments
</span><span class="c1"></span><span class="kd">var</span> <span class="nx">adder</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Function</span><span class="p">(</span><span class="s2">&#34;a&#34;</span><span class="p">,</span> <span class="s2">&#34;b&#34;</span><span class="p">,</span> <span class="s2">&#34;return a + b&#34;</span><span class="p">);</span>

<span class="c1">// Call the function
</span><span class="c1"></span><span class="nx">adder</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">);</span>
<span class="c1">// &gt; 8
</span><span class="c1"></span></code></pre></div>

<p>Aenean lacinia bibendum nulla sed consectetur. Etiam porta sem malesuada magna mollis euismod. Fusce dapibus, tellus ac cursus commodo, tortor mauris condimentum nibh, ut fermentum massa.</p>

<h3 id="lists">Lists</h3>

<p>Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Aenean lacinia bibendum nulla sed consectetur. Etiam porta sem malesuada magna mollis euismod. Fusce dapibus, tellus ac cursus commodo, tortor mauris condimentum nibh, ut fermentum massa justo sit amet risus.</p>

<ul>
<li>Praesent commodo cursus magna, vel scelerisque nisl consectetur et.</li>
<li>Donec id elit non mi porta gravida at eget metus.</li>
<li>Nulla vitae elit libero, a pharetra augue.</li>
</ul>

<p>Donec ullamcorper nulla non metus auctor fringilla. Nulla vitae elit libero, a pharetra augue.</p>

<ol>
<li>Vestibulum id ligula porta felis euismod semper.</li>
<li>Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus.</li>
<li>Maecenas sed diam eget risus varius blandit sit amet non magna.</li>
</ol>

<p>Cras mattis consectetur purus sit amet fermentum. Sed posuere consectetur est at lobortis.</p>

<dl>
  <dt>HyperText Markup Language (HTML)</dt>
  <dd>The language used to describe and define the content of a Web page</dd>

  <dt>Cascading Style Sheets (CSS)</dt>
  <dd>Used to describe the appearance of Web content</dd>

  <dt>JavaScript (JS)</dt>
  <dd>The programming language used to build advanced Web sites and applications</dd>
</dl>

<p>Integer posuere erat a ante venenatis dapibus posuere velit aliquet. Morbi leo risus, porta ac consectetur ac, vestibulum at eros. Nullam quis risus eget urna mollis ornare vel eu leo.</p>

<h3 id="tables">Tables</h3>

<p>Aenean lacinia bibendum nulla sed consectetur. Lorem ipsum dolor sit amet, consectetur adipiscing elit.</p>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Upvotes</th>
      <th>Downvotes</th>
    </tr>
  </thead>
  <tfoot>
    <tr>
      <td>Totals</td>
      <td>21</td>
      <td>23</td>
    </tr>
  </tfoot>
  <tbody>
    <tr>
      <td>Alice</td>
      <td>10</td>
      <td>11</td>
    </tr>
    <tr>
      <td>Bob</td>
      <td>4</td>
      <td>3</td>
    </tr>
    <tr>
      <td>Charlie</td>
      <td>7</td>
      <td>9</td>
    </tr>
  </tbody>
</table>

<p>Nullam id dolor id nibh ultricies vehicula ut id elit. Sed posuere consectetur est at lobortis. Nullam quis risus eget urna mollis ornare vel eu leo.</p>

<hr />

<p>Want to see something else added? <a href="https://github.com/poole/poole/issues/new">Open an issue.</a></p>

    </div>
  
    <div class="post">
        <h1 class="post-title"><a href="https://purple-screen.com/2013/12/31/whats-jekyll/">What&#39;s Jekyll?</a></h1>
        <span class="post-date">Dec 31 2013</span>
        <p><a href="http://jekyllrb.com">Jekyll</a> is a static site generator, an open-source tool for creating simple yet powerful websites of all shapes and sizes. From <a href="https://github.com/mojombo/jekyll/blob/master/README.markdown">the project&rsquo;s readme</a>:</p>

<blockquote>
<p>Jekyll is a simple, blog aware, static site generator. It takes a template directory [&hellip;] and spits out a complete, static website suitable for serving with Apache or your favorite web server. This is also the engine behind GitHub Pages, which you can use to host your project’s page or blog right here from GitHub.</p>
</blockquote>

<p>It&rsquo;s an immensely useful tool and one we encourage you to use here with Hyde.</p>

<p>Find out more by <a href="https://github.com/mojombo/jekyll">visiting the project on GitHub</a>.</p>

    </div>
  
    <div class="post">
        <h1 class="post-title"><a href="https://purple-screen.com/2013/12/23/powershell-scheduled-job-output-redirection/">PowerShell scheduled job output redirection</a></h1>
        <span class="post-date">Dec 23 2013</span>
        <p>Scheduling the script execution is rather common task. You might know that it&#8217;s possible to manage scheduled tasks in PowerShell with built-in ScheduledTask module cmdlets. To keep track whether the task run successfully or not it&#8217;s quite useful to redirect the output of the script to a file. PowerShell allows output redirection for all stream types (standard/error/warning/etc), see <a title="TechNet about_Redirection help topic" href="http://technet.microsoft.com/en-us/library/hh847746.aspx" target="_blank">TechNet about_Redirection help topic</a>.</p>

<p>To be able to run your scripts with -Verbose option you should leverage Advanced_Functions syntax (see <a href="http://technet.microsoft.com/en-us/library/hh847806.aspx" title="about_Functions_Advanced">another Core About topic</a>). Just add couple of strings to the beginning of the script</p>

<pre class="lang:ps decode:true">[CmdletBinding()]
Param ()</pre>

<p>and use Write-Verbose cmdlet throughout the script where chatty output is needed. At first glance it seems to be an easy task to combine all mentioned together, but in fact I saw lots of questions across the web where people struggled to make it work. Indeed it took much effort before I succeeded. I&#8217;ve tested many different configuration and most of them didn&#8217;t work for me too. That&#8217;s what I came up with and it worked for me:</p>

<pre class="lang:ps decode:true">Register-ScheduledJob -Name Scheduled -Credential $Cred -Trigger (New-JobTrigger -Daily -At '11:00 PM') -ScriptBlock { D:\Scheduled.ps1 -Verbose *&gt; 'D:\Scheduled.log' }</pre>

    </div>
  
    <div class="post">
        <h1 class="post-title"><a href="https://purple-screen.com/2013/12/01/veeam-slow-backup/">Veeam slow backup</a></h1>
        <span class="post-date">Dec 1 2013</span>
        <p>One day I suddenly noticed that backup jobs could no longer fit the backup window. While investigating the issue I found tons of log records pointing that before processing every VM in the job Veeam tries to clean up all the snapshots created by its own for backup purposes. In some cases they were manually deleted or lost for some reason, but the records were still kept in the database.</p>

<p>So the root cause of slow backup is detected. To fix it first ensure that all backup jobs are stopped. If so, delete all snapshots with names containing &#8216;VEEAM&#8217; and &#8216;Consolidate helper&#8217; in vSphere inventory. Then go to Veeam database and clear the VmWareSnapshot table <strong>(DELETE FROM VmWareSnapshots)</strong>. It&#8217;s recommended to stop VeeamBackup service before executing the query against DB.</p>

<p>That&#8217;s it. Restart your jobs and enjoy the rates you used to see!</p>

    </div>
  
    <div class="post">
        <h1 class="post-title"><a href="https://purple-screen.com/2013/11/23/vcenter-converter-5-low-processing-rate/">vCenter Converter 5 low processing rate</a></h1>
        <span class="post-date">Nov 23 2013</span>
        <p>If you experience too slow conversion speed while doing P2V migration or other conversion task and see no reason for this, the solution might be to disable SSL encryption for data transfers between agent and server. To accomplish this open the file &#8216;C:\ProgramData\VMware\VMware vCenter Converter Standalone\converter-worker.xml&#8217;, navigate to <strong>nfc</strong> section of xml and set false in <strong>useSSL</strong> tag. Restarting &#8216;Converter Worker&#8217; service is required. Hope this&#8217;ll help!</p>

    </div>
  
    <div class="post">
        <h1 class="post-title"><a href="https://purple-screen.com/2013/10/27/esxcli-namespace-tree/">Esxcli namespace tree</a></h1>
        <span class="post-date">Oct 27 2013</span>
        <p>Every time a new ESXi version released I wonder what the functionality was added to <em>esxcli</em>. As you know all available namespaces and commands can be retrieved by typing <em>esxcli command list</em> in the console. To make the output look pretty I&#8217;ve written a couple of lines of PoSH code that generates the handy namespaces tree view.</p>

<pre class="lang:ps decode:true " title="esxcli" >$esxcli = Get-VMHost $Name | Get-EsxCli
$EsxcliNamespaceFile = [IO.File]::CreateText('D:\esxcli.txt')
$EsxcliNamespaceTree = $esxcli.esxcli.command.list()
$Commands = @()
foreach ($Namespace in $EsxcliNamespaceTree) {
    $Commands += @{Path = $Namespace.Namespace.Split('.'); Operation = $Namespace.Command }
}
 
function Expand-Tree ($Tree, $TabNum = 0) {
    $Tree | Group -Property {@($_.Path)[0]} | Sort Name | % {
        if ($_.Group.Path -eq $null) { $EsxcliNamespaceFile.Write(" $(($_.Group.Operation | Sort) -join ',')"); return }
        $EsxcliNamespaceFile.Write("`n$(if ($TabNum) { 1..$TabNum | % { "`t" } })$($_.Name)")
        $_.Group | % { $_.Path = $_.Path | Select -Skip 1 }
        Expand-Tree -Tree ($_.Group | Sort @{E={$_.Path.Count}}) -TabNum ($TabNum + 1)
    }
}
Expand-Tree -Tree $Commands
$EsxcliNamespaceFile.Close()</pre>

<p>The reason I&#8217;ve used the .NET class instead of Add-Content / Out-File cmdlets is that the latter append the new line.</p>

<p><a href="https://dl.dropboxusercontent.com/u/2398632/namespace.txt" title="EsxcliNamespaceTree" target="_blank">Here</a> is for the latest version 5.5.</p>

    </div>
  
    <div class="post">
        <h1 class="post-title"><a href="https://purple-screen.com/2013/09/29/omnitracker-automation/">OmniTracker automation</a></h1>
        <span class="post-date">Sep 29 2013</span>
        <p>Few words outside the virtualization world yet PoSH scripting related.</p>

<p>I&#8217;ve been working for a while in the company that uses <a href="http://www.omninet.de/index.php" title="Omnitracker" target="_blank">Omnitracker</a> as a helpdesk and incident management solution. Using its web interface as well as thick client isn&#8217;t the best experience. And when it comes to do it on a regular basis it turns to a nightmare especially for a scripting guy like me. So what should we do in this situation? Yep, exactly! Automate it!</p>

<p>As others the first thing I&#8217;ve tried is to call Google for help. What was my surprise when I saw nothing relevant at all in the first few pages except the Linkedin profile of a guy who should have the desired skills. Wow, the power of social networks in action! Take a challenge!</p>

<p>Looking through the manuals I&#8217;ve stumbled on the doc describing the automation interface. Good catch! C# there, so the PoSH isn&#8217;t far away. It turned out simple enough and after few tries I&#8217;ve managed to get it work. Couple of functions produced can be found below. As Omnitracker heavily relies on cusmomization most likely you won&#8217;t find it working in your environment but this functions should give you a tip how to handle the objects in OT.</p>

<pre class="lang:ps decode:true " title="OmniTracker" >function Set-OtTicket {
    [CmdletBinding()]
    Param (
        [Parameter(Mandatory)]
        [string[]] $TicketN,
        [Parameter(Mandatory)]
        [ValidateSet('Rejected','InfoRequest','InProgress','Solved')]
        [string] $Status,
        [string] $Server,
        [int] $Port = 5085,
        [System.Management.Automation.PSCredential] $Credential = Get-Credential,
        [string] $Folder
    )
    DynamicParam {
        switch -Regex ($Status) {
            'Rejected|InfoRequest' {
                Add-DynamicParam -ParameterName Comment -ParameterType string -Mandatory
            }
            'InProgress' {
                Add-DynamicParam -ParameterName EndDate -ParameterType DateTime -Mandatory |
                Add-DynamicParam -ParameterName Comment -ParameterType string
            }
            'Solved' {
                Add-DynamicParam -ParameterName Solution -ParameterType string -Mandatory `
                -Options @{ValidateNotNullOrEmpty = $null} |
                Add-DynamicParam -ParameterName Effort -ParameterType float -Mandatory |
                Add-DynamicParam -ParameterName Comment -ParameterType string
            }
        }
    }
    Begin {
        $otApp = New-Object -ComObject OtAut.OtApplication
        $otSession = $otApp.MakeSession($Server, $Port, $Credential.UserName, $Credential.GetNetworkCredential().Password)
    }
    Process {
        $otFolders = $otSession.RequestFolders
        $otFolder = ($otFolders | ? Path -eq $Folder)
        $otFilter = $otFolder.MakeFilter()
        $otFilter.SetSearchExpression("Number:I-$TicketN")
        $otFilter.Save()
        $otRequests = $otFolder.Search($otFilter, $true) # recursive
        $OtRequest = $otRequests.Item(0)
        $OtRequest.Unlock()
 
        $StatusHt = @{Rejected='Rejected'; InfoRequest='Запрос информации'}
 
        $State = $otRequest.UserFields | ? { $_.Definition.Label -eq 'State' }
        switch -Regex ($Status) {
            'Rejected|InfoRequest' {                
                $State.Value = $StatusHt.$Status
            }
            'InProgress' {
                $State.Value = 'In progress'
                $Terms = $otRequest.UserFields | ? { $_.Definition.Label -eq 'Срок решения' }
                $Terms.Value = $PSBoundParameters.EndDate.ToShortDateString()
            }
            'Solved' {
                $State.Value = 'In progress'
                $Terms = $otRequest.UserFields | ? { $_.Definition.Label -eq 'Срок решения' }
                $Terms.Value = (Get-Date).AddDays(1).ToShortDateString()
 
                $otRequest.Save($true, $null, $true)
 
                $Solution_ = $otRequest.UserFields | ? { $_.Definition.Label -eq 'Solution Description'}
                $Solution_.Value = $PSBoundParameters.Solution # formatted text
                $Effort_ = $otRequest.UserFields | ? { $_.Definition.Label -eq 'Effort'}
                $Effort_.Value = $PSBoundParameters.Effort
       
                $Terms.Value = (Get-Date).ToShortDateString()
                $State.Value = 'Solved'
            }
            '.*' {
                if ($PSBoundParameters.Comment) {
                    $Comments = $otRequest.UserFields | ? { $_.Definition.Label -eq 'Comments' }
                    $OtMemoSections = $Comments.TValue
                    $OtMemoSections.Add($PSBoundParameters.Comment)
                    $Comments.TValue = $OtMemoSections
                }
            }
        }
        $otRequest.Save($true, $null, $true)
    }
    End { $otSession.Logoff() }
}</pre>

    </div>
  
    <div class="post">
        <h1 class="post-title"><a href="https://purple-screen.com/2013/09/08/dynamic-parameters/">Dynamic parameters</a></h1>
        <span class="post-date">Sep 8 2013</span>
        <p>Today we gonna touch on dynamic parameters available in advanced functions. These are parameters that are added at run-time depending on the environment. The great example is the parameters that are dynamically exposed to the current parameter set of Get-Item cmdlet based on PS provider (FileSystem, Registry) used.</p>

<p>Faced it once you should have found out that simply adding such a parameter to the function means writing a bunch of code. Let&#8217;s make a life easier! I&#8217;d like to share with you short yet useful function I will actively utilize in my forthcoming scripts. Here it is:</p>

<pre class="expand:true lang:ps decode:true" title="Add-DynamicParam">function Add-DynamicParam {
    Param (
        [Parameter(ValueFromPipeline,HelpMessage='Dictionary to add created dynamic parameter')]
        [System.Management.Automation.RuntimeDefinedParameterDictionary] $ParamDictionary,
        [Parameter(Mandatory)]
        [string] $ParameterName,
        [Parameter(Mandatory)]
        [type] $ParameterType,
        [string[]] $ParameterSetName = '__AllParameterSets',
        [ValidateScript({
            $AcceptedValues = ('Alias','AllowNull','AllowEmptyString','AllowEmptyCollection',`
                               'ValidateCount','ValidateLength','ValidatePattern','ValidateRange',`
                               'ValidateScript','ValidateSet','ValidateNotNull','ValidateNotNullOrEmpty')
            -not (Compare @($_.Keys) $AcceptedValues | ? SideIndicator -eq '&lt;=')
        })]
        [hashtable] $Options,
        [int] $Position,
        [string] $HelpMessage,
        [switch] $ValueFromPipeline,
        [switch] $ValueFromPipelineByPropertyName,        
        [switch] $Mandatory
    )
    $ParamAttribute = [System.Management.Automation.ParameterAttribute]@{
        ParameterSetName = $ParameterSetName; Mandatory = $Mandatory.IsPresent;
        ValueFromPipeline = $ValueFromPipeline.IsPresent;
        ValueFromPipelineByPropertyName = $ValueFromPipelineByPropertyName.IsPresent
    }
    if ($HelpMessage) { $ParamAttribute.HelpMessage = $HelpMessage }
    if ($Position) { $ParamAttribute.Position = $Position }
    $ParamAttributeCollection = New-Object System.Collections.ObjectModel.Collection[System.Attribute]
    $ParamAttributeCollection.Add($ParamAttribute)
    if ($Options) {
        foreach ($Option in $Options.GetEnumerator()) {
            $ParamOptions = New-Object System.Management.Automation.$($Option.Name)Attribute -ArgumentList $Option.Value
            $ParamAttributeCollection.Add($ParamOptions)
        }
    }
    $Param = New-Object System.Management.Automation.RuntimeDefinedParameter($ParameterName, $ParameterType, $ParamAttributeCollection)
    if (-not $ParamDictionary) { $ParamDictionary = New-Object System.Management.Automation.RuntimeDefinedParameterDictionary }
    $ParamDictionary.Add($ParameterName, $Param)
    $ParamDictionary
}</pre>

<p>One note is that parameters created with this function are not available in script&#8217;s body using the parameter&#8217;s name but are exposed via $PSBoundParameters variable.</p>

<p>All the parameter attributes can be set by passing its values in hashtable to <em>-Options</em>. Other common attributes (&#8216;mandatory&#8217; switch, position, accepting values from pipeline) are also available. To add multiple dynamic parameters you should pipe one function call to another. Braindead simple! Here is an example:</p>

<pre class="expand:true lang:ps decode:true " title="DynamicParam usage">DynamicParam {
    if ($Status -eq 'Solved') {
        Add-DynamicParam -ParameterName Solution -ParameterType string -Mandatory -Options @{ValidateNotNullOrEmpty = $null} |
        Add-DynamicParam -ParameterName Effort -ParameterType int -Mandatory -Options @{ValidateSet = (1,2,3)}
    }
}
Process {
    $PSBoundParameters.Solution; $PSBoundParameters.Effort
}</pre>

    </div>
  
</div>

<div class="pagination">
  
  <a class="pagination-item older" href="https://purple-screen.com/page/3/">Older</a>
  

  
  <a class="pagination-item newer" href="https://purple-screen.com/">Newer</a>
  
</div>

      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>
  </body>
</html>

